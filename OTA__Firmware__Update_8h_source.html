<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ThingsBoard Client SDK: src/OTA_Firmware_Update.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ThingsBoard Client SDK<span id="projectnumber">&#160;0.16.0</span>
   </div>
   <div id="projectbrief">Client SDK to connect with ThingsBoard IoT Platform from IoT devices (Arduino, Espressif, etc.)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">OTA_Firmware_Update.h</div></div>
</div><!--header-->
<div class="contents">
<a href="OTA__Firmware__Update_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#ifndef OTA_Firmware_Update_h</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define OTA_Firmware_Update_h</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// Local includes.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &quot;<a class="code" href="Attribute__Request_8h.html">Attribute_Request.h</a>&quot;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &quot;<a class="code" href="Shared__Attribute__Update_8h.html">Shared_Attribute_Update.h</a>&quot;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &quot;<a class="code" href="OTA__Handler_8h.html">OTA_Handler.h</a>&quot;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;<a class="code" href="IAPI__Implementation_8h.html">IAPI_Implementation.h</a>&quot;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a5ebf1f8fe91fbd653ae67752c6a78113">   11</a></span><a class="code hl_class" href="classuint8__t.html">uint8_t</a> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5ebf1f8fe91fbd653ae67752c6a78113">MAX_FW_TOPIC_SIZE</a> = 33U;</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">   12</a></span><a class="code hl_class" href="classuint8__t.html">uint8_t</a> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a> = 5U;</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#aa992cb37e2c7a00f8508b14d9f051311">   13</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aa992cb37e2c7a00f8508b14d9f051311">NO_FW_REQUEST_RESPONSE</a>[] = <span class="stringliteral">&quot;Did not receive requested shared attribute firmware keys. Ensure keys exist and device is connected&quot;</span>;</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">// Firmware topics.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#acd99ba00ef045495b1f237499bcc0758">   15</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#acd99ba00ef045495b1f237499bcc0758">FIRMWARE_RESPONSE_TOPIC</a>[] = <span class="stringliteral">&quot;v2/fw/response/%u/chunk/&quot;</span>;</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a69a3c6d4208f1b87d6b931b4444cc7d2">   16</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a69a3c6d4208f1b87d6b931b4444cc7d2">FIRMWARE_REQUEST_TOPIC</a>[] = <span class="stringliteral">&quot;v2/fw/request/%u/chunk/%u&quot;</span>;</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">// Firmware data keys.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a6e752cc033415c00c7332e7c39f37f76">   18</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a6e752cc033415c00c7332e7c39f37f76">CURR_FW_TITLE_KEY</a>[] = <span class="stringliteral">&quot;current_fw_title&quot;</span>;</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#af0237a5e7ff787651646fdb32164dbfa">   19</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#af0237a5e7ff787651646fdb32164dbfa">CURR_FW_VER_KEY</a>[] = <span class="stringliteral">&quot;current_fw_version&quot;</span>;</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a7a8f4ae1e65591f00705fc11bd145b35">   20</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a7a8f4ae1e65591f00705fc11bd145b35">FW_ERROR_KEY</a>[] = <span class="stringliteral">&quot;fw_error&quot;</span>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a1c9d70a31ee974932b4f80cca0546eed">   21</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1c9d70a31ee974932b4f80cca0546eed">FW_STATE_KEY</a>[] = <span class="stringliteral">&quot;fw_state&quot;</span>;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">   22</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">FW_VER_KEY</a>[] = <span class="stringliteral">&quot;fw_version&quot;</span>;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">   23</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">FW_TITLE_KEY</a>[] = <span class="stringliteral">&quot;fw_title&quot;</span>;</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">   24</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">FW_CHKS_KEY</a>[] = <span class="stringliteral">&quot;fw_checksum&quot;</span>;</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">   25</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">FW_CHKS_ALGO_KEY</a>[] = <span class="stringliteral">&quot;fw_checksum_algorithm&quot;</span>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">   26</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">FW_SIZE_KEY</a>[] = <span class="stringliteral">&quot;fw_size&quot;</span>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#af7cb48750e8070f5634d513b403c6b55">   27</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#af7cb48750e8070f5634d513b403c6b55">CHECKSUM_AGORITM_MD5</a>[] = <span class="stringliteral">&quot;MD5&quot;</span>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a5dcc38cff5758cac9ad5432d5a2a7072">   28</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dcc38cff5758cac9ad5432d5a2a7072">CHECKSUM_AGORITM_SHA256</a>[] = <span class="stringliteral">&quot;SHA256&quot;</span>;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a87289161bdf75575aa20139a7974ed05">   29</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a87289161bdf75575aa20139a7974ed05">CHECKSUM_AGORITM_SHA384</a>[] = <span class="stringliteral">&quot;SHA384&quot;</span>;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#aa3e230ec4d8f484f003fda581e3c87f6">   30</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aa3e230ec4d8f484f003fda581e3c87f6">CHECKSUM_AGORITM_SHA512</a>[] = <span class="stringliteral">&quot;SHA512&quot;</span>;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">// Log messages.</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a589323110c6a36b41709bb09a27c1a74">   32</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a589323110c6a36b41709bb09a27c1a74">NUMBER_PRINTF</a>[] = <span class="stringliteral">&quot;%u&quot;</span>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a88b2200e2eff8fbccdb41622c5e5c84a">   33</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a88b2200e2eff8fbccdb41622c5e5c84a">NO_FW</a>[] = <span class="stringliteral">&quot;Missing shared attribute firmware keys. Ensure you assigned an OTA update with binary&quot;</span>;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#aba7362cb92b1d8bd87fe318083b99ce3">   34</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aba7362cb92b1d8bd87fe318083b99ce3">EMPTY_FW</a>[] = <span class="stringliteral">&quot;Received shared attribute firmware keys were NULL&quot;</span>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a4e380ad85af01a3d1d4a73ac8659014b">   35</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a4e380ad85af01a3d1d4a73ac8659014b">FW_NOT_FOR_US</a>[] = <span class="stringliteral">&quot;Received firmware title (%s) is different and not meant for this device (%s)&quot;</span>;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#afdca237791429c7126164c89c1a984e3">   36</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#afdca237791429c7126164c89c1a984e3">FW_CHKS_ALGO_NOT_SUPPORTED</a>[] = <span class="stringliteral">&quot;Received checksum algorithm (%s) is not supported&quot;</span>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a3be66108a5d6dc9198af9a8752184537">   37</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a3be66108a5d6dc9198af9a8752184537">NOT_ENOUGH_RAM</a>[] = <span class="stringliteral">&quot;Temporary allocating more internal client buffer failed, decrease OTA chunk size or decrease overall heap usage&quot;</span>;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="OTA__Firmware__Update_8h.html#a5f835a1753421c8bf537dfce5b182e0a">   38</a></span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5f835a1753421c8bf537dfce5b182e0a">RESETTING_FAILED</a>[] = <span class="stringliteral">&quot;Preparing for OTA firmware updates failed, attributes might be NULL&quot;</span>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#if THINGSBOARD_ENABLE_DEBUG</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> PAGE_BREAK[] = <span class="stringliteral">&quot;=================================&quot;</span>;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> NEW_FW[] = <span class="stringliteral">&quot;A new Firmware is available:&quot;</span>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> FROM_TOO[] = <span class="stringliteral">&quot;(%s) =&gt; (%s)&quot;</span>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="keywordtype">char</span> <span class="keyword">constexpr</span> DOWNLOADING_FW[] = <span class="stringliteral">&quot;Attempting to download over MQTT...&quot;</span>;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#endif </span><span class="comment">// THINGSBOARD_ENABLE_DEBUG</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Logger = DefaultLogger&gt;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html">   51</a></span><span class="keyword">class </span><a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a> : <span class="keyword">public</span> <a class="code hl_class" href="classIAPI__Implementation.html">IAPI_Implementation</a> {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#if THINGSBOARD_ENABLE_DYNAMIC</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="keyword">using </span><a class="code hl_class" href="classAttribute__Request__Callback.html">Request_Callback_Value</a> = <a class="code hl_class" href="classAttribute__Request__Callback.html">Attribute_Request_Callback</a>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keyword">using </span><a class="code hl_class" href="classAttribute__Request.html">Request_Callback_Container</a> = <a class="code hl_class" href="classAttribute__Request.html">Attribute_Request&lt;Logger&gt;</a>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <span class="keyword">using </span><a class="code hl_class" href="classShared__Attribute__Callback.html">Update_Callback_Value</a> = <a class="code hl_class" href="classShared__Attribute__Callback.html">Shared_Attribute_Callback</a>;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keyword">using </span><a class="code hl_class" href="classShared__Attribute__Update.html">Update_Callback_Container</a> = <a class="code hl_class" href="classShared__Attribute__Update.html">Shared_Attribute_Update&lt;Logger&gt;</a>;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="keyword">using </span><a class="code hl_class" href="classAttribute__Request__Callback.html">Request_Callback_Value</a> = <a class="code hl_class" href="classAttribute__Request__Callback.html">Attribute_Request_Callback&lt;OTA_ATTRIBUTE_KEYS_AMOUNT&gt;</a>;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keyword">using </span><a class="code hl_class" href="classAttribute__Request.html">Request_Callback_Container</a> = <a class="code hl_class" href="classAttribute__Request.html">Attribute_Request&lt;1U, OTA_ATTRIBUTE_KEYS_AMOUNT, Logger&gt;</a>;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keyword">using </span><a class="code hl_class" href="classShared__Attribute__Callback.html">Update_Callback_Value</a> = <a class="code hl_class" href="classShared__Attribute__Callback.html">Shared_Attribute_Callback&lt;OTA_ATTRIBUTE_KEYS_AMOUNT&gt;</a>;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keyword">using </span><a class="code hl_class" href="classShared__Attribute__Update.html">Update_Callback_Container</a> = <a class="code hl_class" href="classShared__Attribute__Update.html">Shared_Attribute_Update&lt;1U, OTA_ATTRIBUTE_KEYS_AMOUNT, Logger&gt;</a>;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#endif </span><span class="comment">// THINGSBOARD_ENABLE_DYNAMIC</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a98b81386a6b556e8fe321dc1bd3859b4">   66</a></span>    <a class="code hl_function" href="classOTA__Firmware__Update.html#a98b81386a6b556e8fe321dc1bd3859b4">OTA_Firmware_Update</a>()</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>      : m_subscribe_api_callback()</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      , m_send_json_callback()</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>      , m_send_json_string_callback()</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>      , m_subscribe_topic_callback()</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      , m_unsubscribe_topic_callback()</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>      , m_get_receive_size_callback()</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>      , m_get_send_size_callback()</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>      , m_set_buffer_size_callback()</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      , m_get_request_id_callback()</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      , m_fw_callback()</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>      , m_previous_buffer_size(0U)</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>      , m_changed_buffer_size(false)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>#if <a class="code hl_define" href="Configuration_8h.html#a859baa65322bcd8c0d5239c46c60d71c">THINGSBOARD_ENABLE_STL</a></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>      , m_ota(std::bind(&amp;<a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>::Publish_Chunk_Request, this, std::placeholders::_1, std::placeholders::_2), std::bind(&amp;<a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>::Firmware_Send_State, this, std::placeholders::_1, std::placeholders::_2), std::bind(&amp;<a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>::Firmware_OTA_Unsubscribe, this))</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>#else</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      , m_ota(<a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>::staticPublishChunk, <a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>::staticFirmwareSend, <a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>::staticUnsubscribe)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>#endif <span class="comment">// THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>      , m_response_topic()</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      , m_fw_attribute_update()</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>      , m_fw_attribute_request()</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        <span class="comment">// Can be ignored, because the topic is set correctly once we start an update anyway, therefore we simply insert 0 as the request id for now.</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        <span class="comment">// It just has to be set to an actual value that is not an empty string, because that would make the internal callback receive all other responses from the server as well,</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        <span class="comment">// even if they are not meant for this class and we are not currently updating the device</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        (void)snprintf(m_response_topic, <span class="keyword">sizeof</span>(m_response_topic), <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#acd99ba00ef045495b1f237499bcc0758">FIRMWARE_RESPONSE_TOPIC</a>, 0U);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="preprocessor">#if !THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        m_subscribedInstance = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="preprocessor">#endif </span><span class="comment">// !THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#ac84b0f4d54acddc83b1d41ced7ac08db">   97</a></span>    <a class="code hl_function" href="classOTA__Firmware__Update.html#ac84b0f4d54acddc83b1d41ced7ac08db">~OTA_Firmware_Update</a>() <span class="keyword">override</span> = <span class="keywordflow">default</span>;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a2ecb487c816290cbe8562b0bff79c9c3">  111</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a2ecb487c816290cbe8562b0bff79c9c3">Start_Firmware_Update</a>(<a class="code hl_class" href="classOTA__Update__Callback.html">OTA_Update_Callback</a> <span class="keyword">const</span> &amp; callback) {</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        <span class="keywordflow">if</span> (!Prepare_Firmware_Settings(callback))  {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            Logger::printfln(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5f835a1753421c8bf537dfce5b182e0a">RESETTING_FAILED</a>);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        }</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <span class="keyword">auto</span> &amp; request_timeout = m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#a0cf433764cd8381f50ca2e395cd61438">Get_Request_Timeout</a>();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keyword">constexpr</span> <span class="keywordtype">char</span> <span class="keyword">const</span> * array[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a>] = {<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">FW_CHKS_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">FW_CHKS_ALGO_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">FW_SIZE_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">FW_TITLE_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">FW_VER_KEY</a>};</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span><span class="preprocessor">#if THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <a class="code hl_class" href="classAttribute__Request__Callback.html">Request_Callback_Value</a> <span class="keyword">const</span> fw_request_callback(std::bind(&amp;OTA_Firmware_Update::Firmware_Shared_Attribute_Received, <span class="keyword">this</span>, std::placeholders::_1), request_timeout.Get_Timeout(), std::bind(&amp;OTA_Firmware_Update::Request_Timeout, <span class="keyword">this</span>), array + 0U, array + <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a>);</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <a class="code hl_class" href="classAttribute__Request__Callback.html">Request_Callback_Value</a> <span class="keyword">const</span> fw_request_callback(OTA_Firmware_Update::onStaticFirmwareReceived, request_timeout.Get_Timeout(), OTA_Firmware_Update::onStaticRequestTimeout, array + 0U, array + <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a>);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="preprocessor">#endif </span><span class="comment">// THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <span class="keywordflow">return</span> m_fw_attribute_request.<a class="code hl_function" href="classAttribute__Request.html#af803430565e461bbbb089e6e0b94a1fa">Shared_Attributes_Request</a>(fw_request_callback);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    }</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#ad9eb42198cc35c1be5cc824c7c7c73ca">  130</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#ad9eb42198cc35c1be5cc824c7c7c73ca">Stop_Firmware_Update</a>() {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        m_ota.Stop_Firmware_Update();</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#af88b4fc90163f8120a14cf1819809d30">  146</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#af88b4fc90163f8120a14cf1819809d30">Subscribe_Firmware_Update</a>(<a class="code hl_class" href="classOTA__Update__Callback.html">OTA_Update_Callback</a> <span class="keyword">const</span> &amp; callback) {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="keywordflow">if</span> (!Prepare_Firmware_Settings(callback))  {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            Logger::printfln(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5f835a1753421c8bf537dfce5b182e0a">RESETTING_FAILED</a>);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * array[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a>] = {<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">FW_CHKS_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">FW_CHKS_ALGO_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">FW_SIZE_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">FW_TITLE_KEY</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">FW_VER_KEY</a>};</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="preprocessor">#if THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        <a class="code hl_class" href="classShared__Attribute__Callback.html">Update_Callback_Value</a> <span class="keyword">const</span> fw_update_callback(std::bind(&amp;OTA_Firmware_Update::Firmware_Shared_Attribute_Received, <span class="keyword">this</span>, std::placeholders::_1), array + 0U, array + <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a>);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        <a class="code hl_class" href="classShared__Attribute__Callback.html">Update_Callback_Value</a> <span class="keyword">const</span> fw_update_callback(OTA_Firmware_Update::onStaticFirmwareReceived, array + 0U, array + <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a>);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="preprocessor">#endif </span><span class="comment">// THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        <span class="keywordflow">return</span> m_fw_attribute_update.<a class="code hl_function" href="classShared__Attribute__Update.html#a0b23b1db2f86853020aa5675237402b3">Shared_Attributes_Subscribe</a>(fw_update_callback);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#afcb5f9ea4384bff10b46d740828893d2">  161</a></span>    <a class="code hl_enumeration" href="API__Process__Type_8h.html#ab34b5ae8501eb4438f2d57a4569d41f9">API_Process_Type</a> <a class="code hl_function" href="classOTA__Firmware__Update.html#afcb5f9ea4384bff10b46d740828893d2">Get_Process_Type</a>()<span class="keyword"> const override </span>{</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        <span class="keywordflow">return</span> API_Process_Type::RAW;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a169b0e60e637bd3b81607c8884e6a634">  165</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a169b0e60e637bd3b81607c8884e6a634">Process_Response</a>(<span class="keywordtype">char</span> <span class="keyword">const</span> * topic, <a class="code hl_class" href="classuint8__t.html">uint8_t</a> * payload, uint32_t length)<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        <span class="keyword">auto</span> <span class="keyword">const</span> &amp; request_id = m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#aaed96feb4704aa1797f58691a38b60e4">Get_Request_ID</a>();</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        <span class="keyword">auto</span> <span class="keyword">const</span> chunk = <a class="code hl_function" href="classHelper.html#a920c6602c5c796989d0d725d2856a9b9">Helper::Split_Topic_Into_Request_ID</a>(topic, <a class="code hl_function" href="classHelper.html#a1569fbb44fd76ff1a69ecfa4a0fd71c4">Helper::Calculate_Print_Size</a>(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#acd99ba00ef045495b1f237499bcc0758">FIRMWARE_RESPONSE_TOPIC</a>, request_id));</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        m_ota.Process_Firmware_Packet(chunk, payload, length);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a84d2166c2a98f92f6a6b7d21edf39605">  171</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a84d2166c2a98f92f6a6b7d21edf39605">Process_Json_Response</a>(<span class="keywordtype">char</span> <span class="keyword">const</span> * topic, JsonDocument <span class="keyword">const</span> &amp; data)<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        <span class="comment">// Nothing to do</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a93a49e8c6c9a025ff5fb8a2bdc7769c1">  175</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a93a49e8c6c9a025ff5fb8a2bdc7769c1">Is_Response_Topic_Matching</a>(<span class="keywordtype">char</span> <span class="keyword">const</span> * topic)<span class="keyword"> const override </span>{</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        <span class="keywordflow">return</span> strncmp(m_response_topic, topic, strlen(m_response_topic)) == 0;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    }</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a792333a451c1c98448ad25cc5465cf60">  179</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a792333a451c1c98448ad25cc5465cf60">Unsubscribe</a>()<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <a class="code hl_function" href="classOTA__Firmware__Update.html#ad9eb42198cc35c1be5cc824c7c7c73ca">Stop_Firmware_Update</a>();</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    }</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a96e99e6722b17fb9bb1aa91d61eb6f2b">  184</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a96e99e6722b17fb9bb1aa91d61eb6f2b">Resubscribe_Permanent_Subscriptions</a>()<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <span class="keywordflow">return</span> Firmware_OTA_Subscribe();</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="preprocessor">#if !THINGSBOARD_USE_ESP_TIMER</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#ac34d5eb60c35954fbc6a934e68698f7b">  189</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#ac34d5eb60c35954fbc6a934e68698f7b">loop</a>()<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        m_ota.update();</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="preprocessor">#endif </span><span class="comment">// !THINGSBOARD_USE_ESP_TIMER</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a5b0971ef8aa4b32246a7dfe8947d02ec">  194</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a5b0971ef8aa4b32246a7dfe8947d02ec">Initialize</a>()<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        m_subscribe_api_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(m_fw_attribute_update);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        m_subscribe_api_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(m_fw_attribute_request);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    }</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="classOTA__Firmware__Update.html#a4a2bee6e755623e3bb5bb5fc8593ec3b">  199</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classOTA__Firmware__Update.html#a4a2bee6e755623e3bb5bb5fc8593ec3b">Set_Client_Callbacks</a>(<a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;void, IAPI_Implementation &amp;&gt;::function</a> subscribe_api_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;bool, char const * const, JsonDocument const &amp;&gt;::function</a> send_json_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;bool, char const * const, char const * const&gt;::function</a> send_json_string_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;bool, char const * const&gt;::function</a> subscribe_topic_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;bool, char const * const&gt;::function</a> unsubscribe_topic_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;uint16_t&gt;::function</a> get_receive_size_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;uint16_t&gt;::function</a> get_send_size_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;bool, uint16_t, uint16_t&gt;::function</a> set_buffer_size_callback, <a class="code hl_typedef" href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback&lt;size_t *&gt;::function</a> get_request_id_callback)<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        m_subscribe_api_callback.<a class="code hl_function" href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Set_Callback</a>(subscribe_api_callback);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        m_send_json_callback.<a class="code hl_function" href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Set_Callback</a>(send_json_callback);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        m_send_json_string_callback.Set_Callback(send_json_string_callback);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        m_subscribe_topic_callback.Set_Callback(subscribe_topic_callback);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        m_unsubscribe_topic_callback.Set_Callback(unsubscribe_topic_callback);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        m_get_receive_size_callback.<a class="code hl_function" href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Set_Callback</a>(get_receive_size_callback);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        m_get_send_size_callback.<a class="code hl_function" href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Set_Callback</a>(get_send_size_callback);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        m_set_buffer_size_callback.<a class="code hl_function" href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Set_Callback</a>(set_buffer_size_callback);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        m_get_request_id_callback.<a class="code hl_function" href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Set_Callback</a>(get_request_id_callback);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  <span class="keyword">private</span>:</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="keywordtype">bool</span> Firmware_Send_Info(<span class="keywordtype">char</span> <span class="keyword">const</span> * current_fw_title, <span class="keywordtype">char</span> <span class="keyword">const</span> * current_fw_version) {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        StaticJsonDocument&lt;JSON_OBJECT_SIZE(2U)&gt; current_firmware_info;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        current_firmware_info[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a6e752cc033415c00c7332e7c39f37f76">CURR_FW_TITLE_KEY</a>] = current_fw_title;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        current_firmware_info[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#af0237a5e7ff787651646fdb32164dbfa">CURR_FW_VER_KEY</a>] = current_fw_version;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="keywordflow">return</span> m_send_json_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(<a class="code hl_variable" href="IAPI__Implementation_8h.html#acdde70d1a3e3f67bdb4a12653f591437">TELEMETRY_TOPIC</a>, current_firmware_info);</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    }</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keywordtype">bool</span> Firmware_Send_State(<span class="keywordtype">char</span> <span class="keyword">const</span> * current_fw_state, <span class="keywordtype">char</span> <span class="keyword">const</span> * fw_error = <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        StaticJsonDocument&lt;JSON_OBJECT_SIZE(2U)&gt; current_firmware_state;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        current_firmware_state[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a7a8f4ae1e65591f00705fc11bd145b35">FW_ERROR_KEY</a>] = fw_error;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        current_firmware_state[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1c9d70a31ee974932b4f80cca0546eed">FW_STATE_KEY</a>] = current_fw_state;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="keywordflow">return</span> m_send_json_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(<a class="code hl_variable" href="IAPI__Implementation_8h.html#acdde70d1a3e3f67bdb4a12653f591437">TELEMETRY_TOPIC</a>, current_firmware_state);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="keywordtype">bool</span> Prepare_Firmware_Settings(<a class="code hl_class" href="classOTA__Update__Callback.html">OTA_Update_Callback</a> <span class="keyword">const</span> &amp; callback) {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * current_fw_title = callback.<a class="code hl_function" href="classOTA__Update__Callback.html#af89711fdf8ea13750f8e7e4de4ca06af">Get_Firmware_Title</a>();</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * current_fw_version = callback.<a class="code hl_function" href="classOTA__Update__Callback.html#acc5ec36b5f1c86619f224bf3b027b2f7">Get_Firmware_Version</a>();</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classHelper.html#a72c23d8bd4e90c7dbdeafa419161ce9f">Helper::String_IsNull_Or_Empty</a>(current_fw_title) || <a class="code hl_function" href="classHelper.html#a72c23d8bd4e90c7dbdeafa419161ce9f">Helper::String_IsNull_Or_Empty</a>(current_fw_version)) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!Firmware_Send_Info(current_fw_title, current_fw_version)) {</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        <span class="keywordtype">size_t</span> * p_request_id = m_get_request_id_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>();</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        <span class="keywordflow">if</span> (p_request_id == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            Logger::printfln(<a class="code hl_variable" href="IAPI__Implementation_8h.html#afebce2a417095f35b20e22a508287762">REQUEST_ID_NULL</a>);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        }</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        <span class="keyword">auto</span> &amp; request_id = *p_request_id;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        m_fw_callback = callback;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#a232af9829271e400d9dc87a1db414c15">Set_Request_ID</a>(++request_id);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        (void)snprintf(m_response_topic, <span class="keyword">sizeof</span>(m_response_topic), <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#acd99ba00ef045495b1f237499bcc0758">FIRMWARE_RESPONSE_TOPIC</a>, request_id);</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    }</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordtype">bool</span> Firmware_OTA_Subscribe() {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <span class="keywordtype">bool</span> Firmware_OTA_Unsubscribe() {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        <span class="comment">// Buffer size has been set to another value before the update,</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <span class="comment">// to allow to receive ota chunck packets that might be much bigger than the normal</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <span class="comment">// buffer size would allow, therefore we return to the previous value to decrease overall memory usage</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        <span class="keywordflow">if</span> (m_changed_buffer_size) {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>            (void)m_set_buffer_size_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(m_previous_buffer_size, m_get_send_size_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>());</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        }</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <span class="comment">// Reset now not needed private member variables</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        m_fw_callback = <a class="code hl_class" href="classOTA__Update__Callback.html">OTA_Update_Callback</a>();</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    }</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="keywordtype">bool</span> Publish_Chunk_Request(<span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; request_id, <span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; request_chunck) {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        uint16_t <span class="keyword">const</span> &amp; chunk_size = m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#a296f37cba143d7f207fcae3c8d34de7e">Get_Chunk_Size</a>();</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        <span class="keywordtype">char</span> size[<a class="code hl_function" href="classHelper.html#a1569fbb44fd76ff1a69ecfa4a0fd71c4">Helper::Calculate_Print_Size</a>(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a589323110c6a36b41709bb09a27c1a74">NUMBER_PRINTF</a>, chunk_size)] = {};</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        (void)snprintf(size, <span class="keyword">sizeof</span>(size), <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a589323110c6a36b41709bb09a27c1a74">NUMBER_PRINTF</a>, chunk_size);</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <span class="keywordtype">char</span> topic[<a class="code hl_function" href="classHelper.html#a1569fbb44fd76ff1a69ecfa4a0fd71c4">Helper::Calculate_Print_Size</a>(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a69a3c6d4208f1b87d6b931b4444cc7d2">FIRMWARE_REQUEST_TOPIC</a>, request_id, request_chunck)] = {};</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        (void)snprintf(topic, <span class="keyword">sizeof</span>(topic), <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a69a3c6d4208f1b87d6b931b4444cc7d2">FIRMWARE_REQUEST_TOPIC</a>, request_id, request_chunck);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        <span class="keywordflow">return</span> m_send_json_string_callback.Call_Callback(topic, size);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    }</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="keywordtype">void</span> Request_Timeout() {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        Logger::printfln(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aa992cb37e2c7a00f8508b14d9f051311">NO_FW_REQUEST_RESPONSE</a>);</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aa992cb37e2c7a00f8508b14d9f051311">NO_FW_REQUEST_RESPONSE</a>);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    }</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keywordtype">void</span> Firmware_Shared_Attribute_Received(JsonObjectConst <span class="keyword">const</span> &amp; data) {</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        <span class="comment">// Check if firmware is available for our device</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <span class="keywordflow">if</span> (!data.containsKey(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">FW_VER_KEY</a>) || !data.containsKey(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">FW_TITLE_KEY</a>) || !data.containsKey(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">FW_CHKS_KEY</a>) || !data.containsKey(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">FW_CHKS_ALGO_KEY</a>) || !data.containsKey(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">FW_SIZE_KEY</a>)) {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            Logger::printfln(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a88b2200e2eff8fbccdb41622c5e5c84a">NO_FW</a>);</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a88b2200e2eff8fbccdb41622c5e5c84a">NO_FW</a>);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * fw_title = data[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">FW_TITLE_KEY</a>];</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * fw_version = data[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">FW_VER_KEY</a>];</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * fw_checksum = data[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">FW_CHKS_KEY</a>];</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * fw_algorithm = data[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">FW_CHKS_ALGO_KEY</a>];</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        <span class="keyword">auto</span> <span class="keyword">const</span> fw_size = data[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">FW_SIZE_KEY</a>];</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * curr_fw_title = m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#af89711fdf8ea13750f8e7e4de4ca06af">Get_Firmware_Title</a>();</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> * curr_fw_version = m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#acc5ec36b5f1c86619f224bf3b027b2f7">Get_Firmware_Version</a>();</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        <span class="keywordflow">if</span> (fw_title == <span class="keyword">nullptr</span> || fw_version == <span class="keyword">nullptr</span> || curr_fw_title == <span class="keyword">nullptr</span> || curr_fw_version == <span class="keyword">nullptr</span> || fw_algorithm == <span class="keyword">nullptr</span> || fw_checksum == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            Logger::printfln(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aba7362cb92b1d8bd87fe318083b99ce3">EMPTY_FW</a>);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aba7362cb92b1d8bd87fe318083b99ce3">EMPTY_FW</a>);</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        }</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        <span class="comment">// If firmware version and title is the same, we do not initiate an update, because we expect the type of binary to be the same one we are currently using</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        <span class="comment">// and therefore updating would be useless as we have already updated previously</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(curr_fw_title, fw_title, strlen(curr_fw_title)) == 0U &amp;&amp; strncmp(curr_fw_version, fw_version, strlen(curr_fw_version)) == 0U) {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#aa132366912bdb65c280e5f73136b84da">FW_STATE_UPDATED</a>);</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        }</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="comment">// If firmware title is not the same, we do not initiate an update, because we expect the binary to be for another type of device</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="comment">// and downloading it on this device could possibly cause hardware issues or even destroy the device</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(curr_fw_title, fw_title, strlen(curr_fw_title)) != 0U) {</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>            <span class="keywordtype">char</span> message[strlen(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a4e380ad85af01a3d1d4a73ac8659014b">FW_NOT_FOR_US</a>) + strlen(fw_title) + strlen(curr_fw_title) + 3U] = {};</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>            (void)snprintf(message, <span class="keyword">sizeof</span>(message), <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a4e380ad85af01a3d1d4a73ac8659014b">FW_NOT_FOR_US</a>, fw_title, curr_fw_title);</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>            Logger::printfln(message);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a>, message);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        }</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        <a class="code hl_class" href="classmbedtls__md__type__t.html">mbedtls_md_type_t</a> fw_checksum_algorithm = <a class="code hl_class" href="classmbedtls__md__type__t.html">mbedtls_md_type_t</a>{};</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#af7cb48750e8070f5634d513b403c6b55">CHECKSUM_AGORITM_MD5</a>, fw_algorithm, strlen(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#af7cb48750e8070f5634d513b403c6b55">CHECKSUM_AGORITM_MD5</a>)) == 0U) {</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            fw_checksum_algorithm = mbedtls_md_type_t::MBEDTLS_MD_MD5;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>        }</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dcc38cff5758cac9ad5432d5a2a7072">CHECKSUM_AGORITM_SHA256</a>, fw_algorithm, strlen(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5dcc38cff5758cac9ad5432d5a2a7072">CHECKSUM_AGORITM_SHA256</a>)) == 0U) {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>            fw_checksum_algorithm = mbedtls_md_type_t::MBEDTLS_MD_SHA256;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        }</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a87289161bdf75575aa20139a7974ed05">CHECKSUM_AGORITM_SHA384</a>, fw_algorithm, strlen(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a87289161bdf75575aa20139a7974ed05">CHECKSUM_AGORITM_SHA384</a>)) == 0U) {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            fw_checksum_algorithm = mbedtls_md_type_t::MBEDTLS_MD_SHA384;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aa3e230ec4d8f484f003fda581e3c87f6">CHECKSUM_AGORITM_SHA512</a>, fw_algorithm, strlen(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#aa3e230ec4d8f484f003fda581e3c87f6">CHECKSUM_AGORITM_SHA512</a>)) == 0U) {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>            fw_checksum_algorithm = mbedtls_md_type_t::MBEDTLS_MD_SHA512;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        }</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>            <span class="keywordtype">char</span> message[strlen(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#afdca237791429c7126164c89c1a984e3">FW_CHKS_ALGO_NOT_SUPPORTED</a>) + strlen(fw_algorithm) + 2U] = {};</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            (void)snprintf(message, <span class="keyword">sizeof</span>(message), <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#afdca237791429c7126164c89c1a984e3">FW_CHKS_ALGO_NOT_SUPPORTED</a>, fw_algorithm);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>            Logger::printfln(message);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a>, message);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        }</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#ad7a4b43de7cae9ef0888ce320127f66e">Call_Update_Starting_Callback</a>();</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        <span class="keywordtype">bool</span> <span class="keyword">const</span> result = Firmware_OTA_Subscribe();</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        <span class="keywordflow">if</span> (!result) {</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            m_fw_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(result);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        }</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span><span class="preprocessor">#if THINGSBOARD_ENABLE_DEBUG</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        Logger::printfln(PAGE_BREAK);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        Logger::printfln(NEW_FW);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <span class="keywordtype">char</span> firmware[strlen(FROM_TOO) + strlen(curr_fw_version) + strlen(fw_version) + 3U] = {};</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        (void)snprintf(firmware, <span class="keyword">sizeof</span>(firmware), FROM_TOO, curr_fw_version, fw_version);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        Logger::printfln(firmware);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        Logger::printfln(DOWNLOADING_FW);</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="preprocessor">#endif </span><span class="comment">// THINGSBOARD_ENABLE_DEBUG</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        <span class="keyword">const</span> uint16_t&amp; chunk_size = m_fw_callback.<a class="code hl_function" href="classOTA__Update__Callback.html#a296f37cba143d7f207fcae3c8d34de7e">Get_Chunk_Size</a>();</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        <span class="comment">// Get the previous buffer size and cache it so the previous settings can be restored after the update has finished.</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        m_previous_buffer_size = m_get_receive_size_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>();</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        m_changed_buffer_size = m_previous_buffer_size &lt; (chunk_size + 50U);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        <span class="comment">// Increase size of receive buffer according to the actual chunk size required for the OTA update to work correctly.</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        <span class="keywordflow">if</span> (m_changed_buffer_size &amp;&amp; !m_set_buffer_size_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(chunk_size + 50U, m_get_send_size_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>())) {</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            Logger::printfln(<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a3be66108a5d6dc9198af9a8752184537">NOT_ENOUGH_RAM</a>);</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>            Firmware_Send_State(<a class="code hl_variable" href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a>, <a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a3be66108a5d6dc9198af9a8752184537">NOT_ENOUGH_RAM</a>);</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>            m_fw_callback.<a class="code hl_function" href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Call_Callback</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>        }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>        m_ota.Start_Firmware_Update(m_fw_callback, fw_size, fw_checksum, fw_checksum_algorithm);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    }</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="preprocessor">#if !THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> onStaticFirmwareReceived(JsonDocument <span class="keyword">const</span> &amp; data) {</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        <span class="keywordflow">if</span> (m_subscribedInstance == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        }</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        m_subscribedInstance-&gt;Firmware_Shared_Attribute_Received(data);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    }</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> onStaticRequestTimeout() {</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        <span class="keywordflow">if</span> (m_subscribedInstance == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        }</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        m_subscribedInstance-&gt;Request_Timeout();</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> staticPublishChunk(<span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; request_id, <span class="keywordtype">size_t</span> <span class="keyword">const</span> &amp; request_chunck) {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        <span class="keywordflow">if</span> (m_subscribedInstance == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="keywordflow">return</span> m_subscribedInstance-&gt;Publish_Chunk_Request(request_id, request_chunck);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    }</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> staticFirmwareSend(<span class="keywordtype">char</span> <span class="keyword">const</span> * current_fw_state, <span class="keywordtype">char</span> <span class="keyword">const</span> * fw_error = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="keywordflow">if</span> (m_subscribedInstance == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        }</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <span class="keywordflow">return</span> m_subscribedInstance-&gt;Firmware_Send_State(current_fw_state, fw_error);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    }</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> staticUnsubscribe() {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>        <span class="keywordflow">if</span> (m_subscribedInstance == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        <span class="keywordflow">return</span> m_subscribedInstance-&gt;Firmware_OTA_Unsubscribe();</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="keyword">static</span> <a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a>                                               *m_subscribedInstance;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="preprocessor">#endif </span><span class="comment">// !THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;void, IAPI_Implementation &amp;&gt;</a>                    m_subscribe_api_callback = {};            <span class="comment">// Subscribe additional api callback</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;bool, char const * const, JsonDocument const &amp;&gt;</a> m_send_json_callback = {};                <span class="comment">// Send json document callback</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;bool, char const * const, char const * const&gt;</a>   m_send_json_string_callback = {};         <span class="comment">// Send json string callback</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;bool, char const * const&gt;</a>                       m_subscribe_topic_callback = {};          <span class="comment">// Subscribe mqtt topic client callback</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;bool, char const * const&gt;</a>                       m_unsubscribe_topic_callback = {};        <span class="comment">// Unubscribe mqtt topic client callback</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;uint16_t&gt;</a>                                       m_get_receive_size_callback = {};         <span class="comment">// Get client receive buffer size callback</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;uint16_t&gt;</a>                                       m_get_send_size_callback = {};            <span class="comment">// Get client send buffer size callback</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;bool, uint16_t, uint16_t&gt;</a>                       m_set_buffer_size_callback = {};          <span class="comment">// Set client buffer size callback</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <a class="code hl_class" href="classCallback.html">Callback&lt;size_t *&gt;</a>                                       m_get_request_id_callback = {};           <span class="comment">// Get internal request id callback</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <a class="code hl_class" href="classOTA__Update__Callback.html">OTA_Update_Callback</a>                                      m_fw_callback = {};                       <span class="comment">// OTA update response callback</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    uint16_t                                                 m_previous_buffer_size = {};              <span class="comment">// Previous buffer size of the underlying client, used to revert to the previously configured buffer size if it was temporarily increased by the OTA update</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <span class="keywordtype">bool</span>                                                     m_changed_buffer_size = {};               <span class="comment">// Whether the buffer size had to be changed, because the previous internal buffer size was to small to hold the firmware chunks</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_class" href="classOTA__Handler.html">OTA_Handler&lt;Logger&gt;</a>                                      m_ota = {};                               <span class="comment">// Class instance that handles the flashing and creating a hash from the given received binary firmware data</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="keywordtype">char</span>                                                     m_response_topic[<a class="code hl_variable" href="OTA__Firmware__Update_8h.html#a5ebf1f8fe91fbd653ae67752c6a78113">MAX_FW_TOPIC_SIZE</a>] = {}; <span class="comment">// Firmware response topic that contains the specific request ID of the firmware we actually want to download</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    Update_Callback_Container                                m_fw_attribute_update = {};               <span class="comment">// API implementation to be informed if needed fw attributes have been updated</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    Request_Callback_Container                               m_fw_attribute_request = {};              <span class="comment">// API implementation to request the needed fw attributes to start updating</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>};</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="preprocessor">#if !THINGSBOARD_ENABLE_STL</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><a class="code hl_class" href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a> *OTA_Firmware_Update::m_subscribedInstance = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span><span class="preprocessor">#endif </span><span class="comment">// OTA_Firmware_Update_h</span></div>
<div class="ttc" id="aAPI__Process__Type_8h_html_ab34b5ae8501eb4438f2d57a4569d41f9"><div class="ttname"><a href="API__Process__Type_8h.html#ab34b5ae8501eb4438f2d57a4569d41f9">API_Process_Type</a></div><div class="ttdeci">API_Process_Type</div><div class="ttdoc">Possible processing types an API Implementation uses to handle responses from the server.</div><div class="ttdef"><b>Definition:</b> API_Process_Type.h:19</div></div>
<div class="ttc" id="aAttribute__Request_8h_html"><div class="ttname"><a href="Attribute__Request_8h.html">Attribute_Request.h</a></div></div>
<div class="ttc" id="aConfiguration_8h_html_a859baa65322bcd8c0d5239c46c60d71c"><div class="ttname"><a href="Configuration_8h.html#a859baa65322bcd8c0d5239c46c60d71c">THINGSBOARD_ENABLE_STL</a></div><div class="ttdeci">#define THINGSBOARD_ENABLE_STL</div><div class="ttdef"><b>Definition:</b> Configuration.h:42</div></div>
<div class="ttc" id="aIAPI__Implementation_8h_html"><div class="ttname"><a href="IAPI__Implementation_8h.html">IAPI_Implementation.h</a></div></div>
<div class="ttc" id="aIAPI__Implementation_8h_html_acdde70d1a3e3f67bdb4a12653f591437"><div class="ttname"><a href="IAPI__Implementation_8h.html#acdde70d1a3e3f67bdb4a12653f591437">TELEMETRY_TOPIC</a></div><div class="ttdeci">char constexpr TELEMETRY_TOPIC[]</div><div class="ttdef"><b>Definition:</b> IAPI_Implementation.h:33</div></div>
<div class="ttc" id="aIAPI__Implementation_8h_html_afebce2a417095f35b20e22a508287762"><div class="ttname"><a href="IAPI__Implementation_8h.html#afebce2a417095f35b20e22a508287762">REQUEST_ID_NULL</a></div><div class="ttdeci">char constexpr REQUEST_ID_NULL[]</div><div class="ttdef"><b>Definition:</b> IAPI_Implementation.h:24</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a0a89131616c6ab416e3e20acc2b7539a"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a0a89131616c6ab416e3e20acc2b7539a">FW_VER_KEY</a></div><div class="ttdeci">char constexpr FW_VER_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:22</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a1373de9f8a6745fea4cee20f3557856f"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a1373de9f8a6745fea4cee20f3557856f">OTA_ATTRIBUTE_KEYS_AMOUNT</a></div><div class="ttdeci">uint8_t constexpr OTA_ATTRIBUTE_KEYS_AMOUNT</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:12</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a1c9d70a31ee974932b4f80cca0546eed"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a1c9d70a31ee974932b4f80cca0546eed">FW_STATE_KEY</a></div><div class="ttdeci">char constexpr FW_STATE_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:21</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a1ce2742315924ce419a58398229ad283"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a1ce2742315924ce419a58398229ad283">FW_SIZE_KEY</a></div><div class="ttdeci">char constexpr FW_SIZE_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:26</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a3be66108a5d6dc9198af9a8752184537"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a3be66108a5d6dc9198af9a8752184537">NOT_ENOUGH_RAM</a></div><div class="ttdeci">char constexpr NOT_ENOUGH_RAM[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:37</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a4e380ad85af01a3d1d4a73ac8659014b"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a4e380ad85af01a3d1d4a73ac8659014b">FW_NOT_FOR_US</a></div><div class="ttdeci">char constexpr FW_NOT_FOR_US[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:35</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a589323110c6a36b41709bb09a27c1a74"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a589323110c6a36b41709bb09a27c1a74">NUMBER_PRINTF</a></div><div class="ttdeci">char constexpr NUMBER_PRINTF[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:32</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a5dab0599857b8452e9c7b551cd9977f5"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a5dab0599857b8452e9c7b551cd9977f5">FW_TITLE_KEY</a></div><div class="ttdeci">char constexpr FW_TITLE_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:23</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a5dcc38cff5758cac9ad5432d5a2a7072"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a5dcc38cff5758cac9ad5432d5a2a7072">CHECKSUM_AGORITM_SHA256</a></div><div class="ttdeci">char constexpr CHECKSUM_AGORITM_SHA256[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:28</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a5ebf1f8fe91fbd653ae67752c6a78113"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a5ebf1f8fe91fbd653ae67752c6a78113">MAX_FW_TOPIC_SIZE</a></div><div class="ttdeci">uint8_t constexpr MAX_FW_TOPIC_SIZE</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:11</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a5f835a1753421c8bf537dfce5b182e0a"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a5f835a1753421c8bf537dfce5b182e0a">RESETTING_FAILED</a></div><div class="ttdeci">char constexpr RESETTING_FAILED[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:38</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a69a3c6d4208f1b87d6b931b4444cc7d2"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a69a3c6d4208f1b87d6b931b4444cc7d2">FIRMWARE_REQUEST_TOPIC</a></div><div class="ttdeci">char constexpr FIRMWARE_REQUEST_TOPIC[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:16</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a6e752cc033415c00c7332e7c39f37f76"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a6e752cc033415c00c7332e7c39f37f76">CURR_FW_TITLE_KEY</a></div><div class="ttdeci">char constexpr CURR_FW_TITLE_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:18</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a7a8f4ae1e65591f00705fc11bd145b35"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a7a8f4ae1e65591f00705fc11bd145b35">FW_ERROR_KEY</a></div><div class="ttdeci">char constexpr FW_ERROR_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:20</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a87289161bdf75575aa20139a7974ed05"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a87289161bdf75575aa20139a7974ed05">CHECKSUM_AGORITM_SHA384</a></div><div class="ttdeci">char constexpr CHECKSUM_AGORITM_SHA384[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:29</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_a88b2200e2eff8fbccdb41622c5e5c84a"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#a88b2200e2eff8fbccdb41622c5e5c84a">NO_FW</a></div><div class="ttdeci">char constexpr NO_FW[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:33</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_aa3e230ec4d8f484f003fda581e3c87f6"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#aa3e230ec4d8f484f003fda581e3c87f6">CHECKSUM_AGORITM_SHA512</a></div><div class="ttdeci">char constexpr CHECKSUM_AGORITM_SHA512[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:30</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_aa992cb37e2c7a00f8508b14d9f051311"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#aa992cb37e2c7a00f8508b14d9f051311">NO_FW_REQUEST_RESPONSE</a></div><div class="ttdeci">char constexpr NO_FW_REQUEST_RESPONSE[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:13</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_aba7362cb92b1d8bd87fe318083b99ce3"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#aba7362cb92b1d8bd87fe318083b99ce3">EMPTY_FW</a></div><div class="ttdeci">char constexpr EMPTY_FW[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:34</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_abe8835067d499f1a63e68c6ea61e2d08"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#abe8835067d499f1a63e68c6ea61e2d08">FW_CHKS_ALGO_KEY</a></div><div class="ttdeci">char constexpr FW_CHKS_ALGO_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:25</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_acd99ba00ef045495b1f237499bcc0758"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#acd99ba00ef045495b1f237499bcc0758">FIRMWARE_RESPONSE_TOPIC</a></div><div class="ttdeci">char constexpr FIRMWARE_RESPONSE_TOPIC[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:15</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_ae017ecb3524c89e089d16d1809cb48b4"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#ae017ecb3524c89e089d16d1809cb48b4">FW_CHKS_KEY</a></div><div class="ttdeci">char constexpr FW_CHKS_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:24</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_af0237a5e7ff787651646fdb32164dbfa"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#af0237a5e7ff787651646fdb32164dbfa">CURR_FW_VER_KEY</a></div><div class="ttdeci">char constexpr CURR_FW_VER_KEY[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:19</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_af7cb48750e8070f5634d513b403c6b55"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#af7cb48750e8070f5634d513b403c6b55">CHECKSUM_AGORITM_MD5</a></div><div class="ttdeci">char constexpr CHECKSUM_AGORITM_MD5[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:27</div></div>
<div class="ttc" id="aOTA__Firmware__Update_8h_html_afdca237791429c7126164c89c1a984e3"><div class="ttname"><a href="OTA__Firmware__Update_8h.html#afdca237791429c7126164c89c1a984e3">FW_CHKS_ALGO_NOT_SUPPORTED</a></div><div class="ttdeci">char constexpr FW_CHKS_ALGO_NOT_SUPPORTED[]</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:36</div></div>
<div class="ttc" id="aOTA__Handler_8h_html"><div class="ttname"><a href="OTA__Handler_8h.html">OTA_Handler.h</a></div></div>
<div class="ttc" id="aOTA__Handler_8h_html_a7d2b957ac863bb61260dee7d28b72789"><div class="ttname"><a href="OTA__Handler_8h.html#a7d2b957ac863bb61260dee7d28b72789">FW_STATE_FAILED</a></div><div class="ttdeci">char constexpr FW_STATE_FAILED[]</div><div class="ttdef"><b>Definition:</b> OTA_Handler.h:22</div></div>
<div class="ttc" id="aOTA__Handler_8h_html_aa132366912bdb65c280e5f73136b84da"><div class="ttname"><a href="OTA__Handler_8h.html#aa132366912bdb65c280e5f73136b84da">FW_STATE_UPDATED</a></div><div class="ttdeci">char constexpr FW_STATE_UPDATED[]</div><div class="ttdef"><b>Definition:</b> OTA_Handler.h:23</div></div>
<div class="ttc" id="aShared__Attribute__Update_8h_html"><div class="ttname"><a href="Shared__Attribute__Update_8h.html">Shared_Attribute_Update.h</a></div></div>
<div class="ttc" id="aclassAttribute__Request__Callback_html"><div class="ttname"><a href="classAttribute__Request__Callback.html">Attribute_Request_Callback</a></div><div class="ttdoc">Client-side or shared attributes request callback wrapper, contains the needed configuration settings...</div><div class="ttdef"><b>Definition:</b> Attribute_Request_Callback.h:25</div></div>
<div class="ttc" id="aclassAttribute__Request_html"><div class="ttname"><a href="classAttribute__Request.html">Attribute_Request</a></div><div class="ttdoc">Handles the internal implementation of the ThingsBoard client and shared Attribute Request API....</div><div class="ttdef"><b>Definition:</b> Attribute_Request.h:43</div></div>
<div class="ttc" id="aclassAttribute__Request_html_af803430565e461bbbb089e6e0b94a1fa"><div class="ttname"><a href="classAttribute__Request.html#af803430565e461bbbb089e6e0b94a1fa">Attribute_Request::Shared_Attributes_Request</a></div><div class="ttdeci">bool Shared_Attributes_Request(Callback_Value const &amp;callback)</div><div class="ttdoc">Requests one shared attribute, which will call the passed callback. If the key-value pair from the se...</div><div class="ttdef"><b>Definition:</b> Attribute_Request.h:80</div></div>
<div class="ttc" id="aclassCallback_html"><div class="ttname"><a href="classCallback.html">Callback</a></div><div class="ttdoc">General purpose safe callback wrapper. Expects either c-style or c++ style function pointer,...</div><div class="ttdef"><b>Definition:</b> Callback.h:30</div></div>
<div class="ttc" id="aclassCallback_html_a9cb9c819e739fdf44e1a5cdaaf818bc3"><div class="ttname"><a href="classCallback.html#a9cb9c819e739fdf44e1a5cdaaf818bc3">Callback::function</a></div><div class="ttdeci">std::function&lt; return_type(argument_types... arguments)&gt; function</div><div class="ttdoc">Callback signature.</div><div class="ttdef"><b>Definition:</b> Callback.h:34</div></div>
<div class="ttc" id="aclassCallback_html_ab665b8ffd158f44daeb05613bd00c5d8"><div class="ttname"><a href="classCallback.html#ab665b8ffd158f44daeb05613bd00c5d8">Callback::Set_Callback</a></div><div class="ttdeci">void Set_Callback(function callback)</div><div class="ttdoc">Sets the callback method that will be called upon data arrival with the given data that was received....</div><div class="ttdef"><b>Definition:</b> Callback.h:72</div></div>
<div class="ttc" id="aclassCallback_html_ae4574c0ae7c6531b5b298d8dcc183557"><div class="ttname"><a href="classCallback.html#ae4574c0ae7c6531b5b298d8dcc183557">Callback::Call_Callback</a></div><div class="ttdeci">return_type Call_Callback(argument_types const &amp;... arguments) const</div><div class="ttdoc">Calls the callback that was subscribed, when this class instance was initally created.</div><div class="ttdef"><b>Definition:</b> Callback.h:62</div></div>
<div class="ttc" id="aclassHelper_html_a1569fbb44fd76ff1a69ecfa4a0fd71c4"><div class="ttname"><a href="classHelper.html#a1569fbb44fd76ff1a69ecfa4a0fd71c4">Helper::Calculate_Print_Size</a></div><div class="ttdeci">static size_t Calculate_Print_Size(char const *format, Args const &amp;... args)</div><div class="ttdoc">Returns the total amount of bytes needed to store the formatted string with null termination,...</div><div class="ttdef"><b>Definition:</b> Helper.h:32</div></div>
<div class="ttc" id="aclassHelper_html_a72c23d8bd4e90c7dbdeafa419161ce9f"><div class="ttname"><a href="classHelper.html#a72c23d8bd4e90c7dbdeafa419161ce9f">Helper::String_IsNull_Or_Empty</a></div><div class="ttdeci">static bool String_IsNull_Or_Empty(char const *str)</div><div class="ttdoc">Returns wheter the given string is either a nullptr or is an empty string, meaning it only contains a...</div><div class="ttdef"><b>Definition:</b> Helper.cpp:27</div></div>
<div class="ttc" id="aclassHelper_html_a920c6602c5c796989d0d725d2856a9b9"><div class="ttname"><a href="classHelper.html#a920c6602c5c796989d0d725d2856a9b9">Helper::Split_Topic_Into_Request_ID</a></div><div class="ttdeci">static size_t Split_Topic_Into_Request_ID(char const *received_topic, size_t const &amp;end_position)</div><div class="ttdoc">Splits the topic at the given position and extracts the request id parameter from the remaining strin...</div><div class="ttdef"><b>Definition:</b> Helper.cpp:31</div></div>
<div class="ttc" id="aclassIAPI__Implementation_html"><div class="ttname"><a href="classIAPI__Implementation.html">IAPI_Implementation</a></div><div class="ttdoc">Base functionality required by all API implementation.</div><div class="ttdef"><b>Definition:</b> IAPI_Implementation.h:37</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html"><div class="ttname"><a href="classOTA__Firmware__Update.html">OTA_Firmware_Update</a></div><div class="ttdoc">Handles the internal implementation of the ThingsBoard over the air firmware update API....</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:51</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a169b0e60e637bd3b81607c8884e6a634"><div class="ttname"><a href="classOTA__Firmware__Update.html#a169b0e60e637bd3b81607c8884e6a634">OTA_Firmware_Update::Process_Response</a></div><div class="ttdeci">void Process_Response(char const *topic, uint8_t *payload, uint32_t length) override</div><div class="ttdoc">Process callback that will be called upon response arrival.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:165</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a2ecb487c816290cbe8562b0bff79c9c3"><div class="ttname"><a href="classOTA__Firmware__Update.html#a2ecb487c816290cbe8562b0bff79c9c3">OTA_Firmware_Update::Start_Firmware_Update</a></div><div class="ttdeci">bool Start_Firmware_Update(OTA_Update_Callback const &amp;callback)</div><div class="ttdoc">Requests the current assigned firmware information on the connected device.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:111</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a4a2bee6e755623e3bb5bb5fc8593ec3b"><div class="ttname"><a href="classOTA__Firmware__Update.html#a4a2bee6e755623e3bb5bb5fc8593ec3b">OTA_Firmware_Update::Set_Client_Callbacks</a></div><div class="ttdeci">void Set_Client_Callbacks(Callback&lt; void, IAPI_Implementation &amp; &gt;::function subscribe_api_callback, Callback&lt; bool, char const *const, JsonDocument const &amp; &gt;::function send_json_callback, Callback&lt; bool, char const *const, char const *const &gt;::function send_json_string_callback, Callback&lt; bool, char const *const &gt;::function subscribe_topic_callback, Callback&lt; bool, char const *const &gt;::function unsubscribe_topic_callback, Callback&lt; uint16_t &gt;::function get_receive_size_callback, Callback&lt; uint16_t &gt;::function get_send_size_callback, Callback&lt; bool, uint16_t, uint16_t &gt;::function set_buffer_size_callback, Callback&lt; size_t * &gt;::function get_request_id_callback) override</div><div class="ttdoc">Sets the underlying callbacks that are required for the different API Implementation to communicate w...</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:199</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a5b0971ef8aa4b32246a7dfe8947d02ec"><div class="ttname"><a href="classOTA__Firmware__Update.html#a5b0971ef8aa4b32246a7dfe8947d02ec">OTA_Firmware_Update::Initialize</a></div><div class="ttdeci">void Initialize() override</div><div class="ttdoc">Method that allows to construct internal objects, after the required callback member methods have bee...</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:194</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a792333a451c1c98448ad25cc5465cf60"><div class="ttname"><a href="classOTA__Firmware__Update.html#a792333a451c1c98448ad25cc5465cf60">OTA_Firmware_Update::Unsubscribe</a></div><div class="ttdeci">bool Unsubscribe() override</div><div class="ttdoc">Unsubcribes all callbacks, to clear up any ongoing subscriptions and stop receiving information over ...</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:179</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a84d2166c2a98f92f6a6b7d21edf39605"><div class="ttname"><a href="classOTA__Firmware__Update.html#a84d2166c2a98f92f6a6b7d21edf39605">OTA_Firmware_Update::Process_Json_Response</a></div><div class="ttdeci">void Process_Json_Response(char const *topic, JsonDocument const &amp;data) override</div><div class="ttdoc">Process callback that will be called upon response arrival.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:171</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a93a49e8c6c9a025ff5fb8a2bdc7769c1"><div class="ttname"><a href="classOTA__Firmware__Update.html#a93a49e8c6c9a025ff5fb8a2bdc7769c1">OTA_Firmware_Update::Is_Response_Topic_Matching</a></div><div class="ttdeci">bool Is_Response_Topic_Matching(char const *topic) const override</div><div class="ttdoc">Compares received response topic and the topic this api implementation handles responses on,...</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:175</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a96e99e6722b17fb9bb1aa91d61eb6f2b"><div class="ttname"><a href="classOTA__Firmware__Update.html#a96e99e6722b17fb9bb1aa91d61eb6f2b">OTA_Firmware_Update::Resubscribe_Permanent_Subscriptions</a></div><div class="ttdeci">bool Resubscribe_Permanent_Subscriptions() override</div><div class="ttdoc">Forwards the call to let the API clear up any ongoing single-event subscriptions (Provision,...</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:184</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_a98b81386a6b556e8fe321dc1bd3859b4"><div class="ttname"><a href="classOTA__Firmware__Update.html#a98b81386a6b556e8fe321dc1bd3859b4">OTA_Firmware_Update::OTA_Firmware_Update</a></div><div class="ttdeci">OTA_Firmware_Update()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:66</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_ac34d5eb60c35954fbc6a934e68698f7b"><div class="ttname"><a href="classOTA__Firmware__Update.html#ac34d5eb60c35954fbc6a934e68698f7b">OTA_Firmware_Update::loop</a></div><div class="ttdeci">void loop() override</div><div class="ttdoc">Internal loop method to update inernal timers for API calls that can timeout.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:189</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_ac84b0f4d54acddc83b1d41ced7ac08db"><div class="ttname"><a href="classOTA__Firmware__Update.html#ac84b0f4d54acddc83b1d41ced7ac08db">OTA_Firmware_Update::~OTA_Firmware_Update</a></div><div class="ttdeci">~OTA_Firmware_Update() override=default</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_ad9eb42198cc35c1be5cc824c7c7c73ca"><div class="ttname"><a href="classOTA__Firmware__Update.html#ad9eb42198cc35c1be5cc824c7c7c73ca">OTA_Firmware_Update::Stop_Firmware_Update</a></div><div class="ttdeci">void Stop_Firmware_Update()</div><div class="ttdoc">Stops any currently ongoing firmware update.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:130</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_af88b4fc90163f8120a14cf1819809d30"><div class="ttname"><a href="classOTA__Firmware__Update.html#af88b4fc90163f8120a14cf1819809d30">OTA_Firmware_Update::Subscribe_Firmware_Update</a></div><div class="ttdeci">bool Subscribe_Firmware_Update(OTA_Update_Callback const &amp;callback)</div><div class="ttdoc">Subscribes to any changes of the assigned firmware information on the connected device.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:146</div></div>
<div class="ttc" id="aclassOTA__Firmware__Update_html_afcb5f9ea4384bff10b46d740828893d2"><div class="ttname"><a href="classOTA__Firmware__Update.html#afcb5f9ea4384bff10b46d740828893d2">OTA_Firmware_Update::Get_Process_Type</a></div><div class="ttdeci">API_Process_Type Get_Process_Type() const override</div><div class="ttdoc">Returns the way the server response should be processed.</div><div class="ttdef"><b>Definition:</b> OTA_Firmware_Update.h:161</div></div>
<div class="ttc" id="aclassOTA__Handler_html"><div class="ttname"><a href="classOTA__Handler.html">OTA_Handler</a></div><div class="ttdoc">Handles the complete processing of received binary firmware data including writing the data into some...</div><div class="ttdef"><b>Definition:</b> OTA_Handler.h:50</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html"><div class="ttname"><a href="classOTA__Update__Callback.html">OTA_Update_Callback</a></div><div class="ttdoc">Over the air firmware update callback wrapper.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.h:19</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_a0cf433764cd8381f50ca2e395cd61438"><div class="ttname"><a href="classOTA__Update__Callback.html#a0cf433764cd8381f50ca2e395cd61438">OTA_Update_Callback::Get_Request_Timeout</a></div><div class="ttdeci">Timeoutable_Request &amp; Get_Request_Timeout()</div><div class="ttdoc">Gets the request timeout callback.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:83</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_a232af9829271e400d9dc87a1db414c15"><div class="ttname"><a href="classOTA__Update__Callback.html#a232af9829271e400d9dc87a1db414c15">OTA_Update_Callback::Set_Request_ID</a></div><div class="ttdeci">void Set_Request_ID(size_t const &amp;request_id)</div><div class="ttdoc">Sets the unique request identifier that is connected to the original request.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:47</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_a296f37cba143d7f207fcae3c8d34de7e"><div class="ttname"><a href="classOTA__Update__Callback.html#a296f37cba143d7f207fcae3c8d34de7e">OTA_Update_Callback::Get_Chunk_Size</a></div><div class="ttdeci">uint16_t Get_Chunk_Size() const</div><div class="ttdoc">Gets the size of the chunks that the firmware binary data will be split into.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:75</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_aaed96feb4704aa1797f58691a38b60e4"><div class="ttname"><a href="classOTA__Update__Callback.html#aaed96feb4704aa1797f58691a38b60e4">OTA_Update_Callback::Get_Request_ID</a></div><div class="ttdeci">size_t const &amp; Get_Request_ID() const</div><div class="ttdoc">Gets the unique request identifier that is connected to the original request.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:43</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_acc5ec36b5f1c86619f224bf3b027b2f7"><div class="ttname"><a href="classOTA__Update__Callback.html#acc5ec36b5f1c86619f224bf3b027b2f7">OTA_Update_Callback::Get_Firmware_Version</a></div><div class="ttdeci">char const * Get_Firmware_Version() const</div><div class="ttdoc">Gets the current firmware version.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:27</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_ad7a4b43de7cae9ef0888ce320127f66e"><div class="ttname"><a href="classOTA__Update__Callback.html#ad7a4b43de7cae9ef0888ce320127f66e">OTA_Update_Callback::Call_Update_Starting_Callback</a></div><div class="ttdeci">void Call_Update_Starting_Callback() const</div><div class="ttdoc">Calls the update starting callback that was subscribed, when this class instance was initally created...</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:59</div></div>
<div class="ttc" id="aclassOTA__Update__Callback_html_af89711fdf8ea13750f8e7e4de4ca06af"><div class="ttname"><a href="classOTA__Update__Callback.html#af89711fdf8ea13750f8e7e4de4ca06af">OTA_Update_Callback::Get_Firmware_Title</a></div><div class="ttdeci">char const * Get_Firmware_Title() const</div><div class="ttdoc">Gets the current firmware title.</div><div class="ttdef"><b>Definition:</b> OTA_Update_Callback.cpp:19</div></div>
<div class="ttc" id="aclassShared__Attribute__Callback_html"><div class="ttname"><a href="classShared__Attribute__Callback.html">Shared_Attribute_Callback</a></div><div class="ttdoc">Shared attribute update callback wrapper, contains the needed configuration settings to create the re...</div><div class="ttdef"><b>Definition:</b> Shared_Attribute_Callback.h:20</div></div>
<div class="ttc" id="aclassShared__Attribute__Update_html"><div class="ttname"><a href="classShared__Attribute__Update.html">Shared_Attribute_Update</a></div><div class="ttdoc">Handles the internal implementation of the ThingsBoard shared Attribute Update API....</div><div class="ttdef"><b>Definition:</b> Shared_Attribute_Update.h:26</div></div>
<div class="ttc" id="aclassShared__Attribute__Update_html_a0b23b1db2f86853020aa5675237402b3"><div class="ttname"><a href="classShared__Attribute__Update.html#a0b23b1db2f86853020aa5675237402b3">Shared_Attribute_Update::Shared_Attributes_Subscribe</a></div><div class="ttdeci">bool Shared_Attributes_Subscribe(InputIterator const &amp;first, InputIterator const &amp;last)</div><div class="ttdoc">Subscribes shared attribute callbacks, that will be called if an update for the containing shared att...</div><div class="ttdef"><b>Definition:</b> Shared_Attribute_Update.h:55</div></div>
<div class="ttc" id="aclassmbedtls__md__type__t_html"><div class="ttname"><a href="classmbedtls__md__type__t.html">mbedtls_md_type_t</a></div></div>
<div class="ttc" id="aclassuint8__t_html"><div class="ttname"><a href="classuint8__t.html">uint8_t</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
